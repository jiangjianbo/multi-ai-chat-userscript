# 研究工作设计说明

## 概述

* 本文的描述内容必须遵循基础规则 [GEMINI.MD](../GEMINI.MD) 的约束。
* 本文的内容描述与其他设计弱相关，除非明确指定要处理本文内容，否则不要自动处理本文，也不要生成本文相关的代码。
* 本文的产出代码可以提供给其他相关模块引用。例如chat-area研究过程生成的HTML内容，可以作为chat-area模块生成HTML时候的参考。



## 研究工作

### 内容块（ChatArea）的页面内容研究

内容块（ChatArea）是主窗口的核心组成部分，其界面元素和交互逻辑均较为复杂。为了确保最终实现的 ChatArea 模块功能完善且交互流畅，我们首先通过一个独立的研究页面来验证其完整的 HTML 结构、CSS 样式和 JavaScript 交互。

本研究的目标是创建一个纯 HTML/CSS/JS 的静态页面 research/chat-area.html。该页面将作为一个高保真原型，完整模拟一个独立的内容块所应具备的所有视觉元素和用户交互行为。

此研究页面需要实现以下关键要素：

1. 整体布局:
    * 头部区域: 固定在顶部，包含 AI 提供商的图标、名称，以及一个用于关闭该内容块的按钮。
    * 对话区域: 占据绝大部分空间，是一个可滚动的容器，用于展示多轮的问答消息。
    * 状态区域: 能够清晰地展示当前 AI 的状态，例如“正在输入...”、“已完成”、“出现错误”等。

2. 消息对（Q&A）:
    * 每个“问题”和“回答”都应作为一个独立的消息单元。
    * 当鼠标悬停在任意消息单元上时，应在其右上角或左下角浮现一个工具栏。

3. 消息工具栏:
    * 复制按钮: 点击后能将该消息单元的完整内容复制到剪贴板。
    * 重试/重新生成按钮: （仅针对问题）提供一个用于重新发送请求的按钮。
    * 点赞/点踩按钮: 用于反馈回答质量的 UI 元素。

4. 交互逻辑 (JavaScript):
    * 实现鼠标悬停时工具栏的平滑显示与隐藏。
    * 实现点击“复制”按钮后的实际复制操作。
    * 模拟 AI 响应过程：例如，在提问后，先显示“正在输入...”状态，然后在短暂延迟后追加一个新的回答消息单元。
    * 关闭按钮应具备功能，点击后可以模拟移除整个内容块的效果。

该研究的产出将作为 src/chat-area.js 模块在生成其实际 HTML 结构和绑定交互事件时的直接参考。

### 原生页面附加内容研究

原生页面的注入除了注入技术之外，还需要保证注入的页面元素能够正常工作。本研究实现对典型的AI聊天页面布局的主要注入元素的HTML和样式研究。

典型的AI聊天页面有一个靠左的边栏（包含会话历史清单、新建会话按钮），内容栏（包含标题、滚动的问答区和底部的提示词输入框和提交按钮）。

本研究的目标是生成一个纯HTML+JS的页面，该页面包含一个完整的原生页面相关的HTML和交互逻辑。输出文件存放在[../research/page-controller.html]()中。

* 同步按钮

主要目的是为了验证“同步按钮”的样式。同步按钮一般放在标题部分。

* 问答工具条

主要目的是为了验证问答工具条的样式。每个问题和答案在鼠标悬浮的时候出现工具条，包含展开/折叠开关按钮、复制按钮。折叠的时候保留一行字高，复制需要复制整个问题或回答内容。

* 索引工具条

主要目的是为了验证问答内容的索引工具条的样式，点击索引按钮为每个答案生成一个索引并支持跳转。索引为垂直窄条，前两个是展开和折叠全部回答的按钮，其后显示数字1、2、3、4的索引，每个数字对应回答的序号，点击跳到回答。索引永远固定悬浮，不随内容区的滚动变化。

### 主窗口页面内容研究

主窗口的布局比较复杂，需要提前把布局逻辑设计完善，本研究实现一个符合要求的主窗口页面HTML和交互代码。输出文件存放在[../research/main-window.html]()中。

主窗口的布局分为三个部分，从上到下分别为：

* 标题栏，分为左中右三个区域，水平划分如下：
  * 左区：从左到右包含产品图标、产品名称、多国语言切换。其中多国语言切换为地球形状，点击出现语言列表，选择之后界面语言切换到选定语言。
  * 中区：包含1、2、4、6布局切换按钮。
  * 右区：包含关闭窗口按钮。
* 内容块区域：根据布局排列内容块
* 提示词输入区：所有元素垂直居中，从左到右包含模型参数切换按钮、文本框和发送按钮。其中模型参数切换按钮是一个固定大小的齿轮，点击之后出现各种开关的选项，发送按钮也是固定大小，文本框填充剩余宽度，并且可以跟随文本内容而变高，在高于五分之一窗口或300px的时候就不再变高，而是出现滚动条。





