我的油猴脚本需求如下：
编程风格：
1. 使用面向对象的风格
2. 把js作为函数写在油猴脚本中，然后组装的时候用fun1.toString()方式把源码注入到html字符串中，然后把html放到新页面。
3. 用传统的function模拟对象，这样可以简化html嵌入js的难度。类似 `function ClassA{ this.prop = xxx; this.method=function(){}; }`，不要用prototype链。

基础逻辑：
1. 每个ai对话页面都会注入一个“同步对比”的按钮，点击之后会打开主窗口，并在主窗口里面做各个ai对话结果的对比
2. 每个ai对话页面都通过通讯机制和ai对话结果进行内容同步
3. 主窗口中填入的提示词内容会通过通讯机制放到每个ai对话页面的文字输入框中，并且发送

类结构定义：
SyncChatWindow对象：负责管理主窗口逻辑，以及和窗口中多个ai聊天页面通讯和控制
ChatArea对象：负责ai对话结果内容块的初始化和管理一个ai的聊天页面和通讯
InjectionController：负责嵌入到ai对话页面里，挂接ai原生聊天页面的各种部件，并接收通讯消息去控制原生页面
MessageNotifier：负责在主窗口、chatarea对话结果和ai对话页面之间的通讯

功能定义：
1. 功能入口注入
  1.1 脚本延迟3秒检测并在页面中增加“同步对比”按钮，页面包括www.kimi.com/chat，https://gemini.google.com/，https://chatgpt.com/，https://chat.deepseek.com/，https://x.com/i/grok，https://www.tongyi.com/
  1.2 同步对比按钮点击之后，检测名字为multi-ai-sync-chat-window的窗口，如果不存在则创建，否则获取该窗口，然后把当前url作为createBlock消息的参数发给他
2. 主窗口逻辑
  2.1 主窗口名字为multi-ai-sync-chat-window，其布局从上到下为：
顶部标题栏：内部从左到右为标题“多个AI同步聊天”，然后是居中的布局按钮组可以切换1、2、3、4、6个对话区域的布局，然后是居右的新对话按钮。
最底下是提示词栏，从左到右包含一个文本输入框，可以输入聊天的提示词，输入框右侧是一个发送按钮。
主内容区域：填充窗口剩余部分，根据布局排列div对话区域，每个对话区域可以chatarea嵌入一个ai聊天页面url。
  2.2 对话区域的创建：当收到带url的消息之后，会在把当前布局切换到下一个更多对话区域的布局，并且增加一个新的对话区域。区域负责创建chatarea，并在chatarea中注入响应代码和加载完成之后执行的初始化代码。
  2.3 提示词发送逻辑：提示词栏的文本在点击发送按钮之后，会发送chat消息到主内容区域的所有对话区域的chatarea。
3. 对话区域逻辑
  3.1 对话区域创建：接收窗口消息来创建对话区域的时候，需要传入布局元素的对话区域的id，然后在这个id下创建对话区域的布局，
  3.2 布局包括如下：
区域顶部标题：从左到右包含：
* ai名称，左对齐，可下拉列表中切换ai，新ai的区域会替换当前区域的位置，
* web检索标志开关，跟ai名称在同一组都是左对齐，点击之后会发送config消息给chatarea页面，切换里的检索标志开关（如果有的话），
* 分享标志，跟关闭对话框同一组，都是右对齐，点击之后发送share消息给chatarea页面，模拟点击分享按钮
* 独立窗口打开标志，跟关闭对话框同一组，都是右对齐，点击之后在新窗口中打开chatarea的url，但是当前区域不变
* 关闭对话区域标志，右对齐，在最右边，点击之后关闭当前对话区域
区域底部隐藏的输入框（鼠标浮动出现浮动的向上箭头，不影响页面其他布局，点击之后才出现输入框，输入后回车就发送消息到原生页面），
区域内容：填充区域剩余部分，并展示原生页面抓取的对话内容，根据createBlock消息中包含的url来判断是哪一种ai页面。
  3.3 对话区域chatarea内的事件响应：newMsg消息，负责将消息文本填充到原生页面的对话输入框中并模拟点击发送；share消息，模拟点击原生页面中的共享按钮生成会话共享链接；newChat消息，负责模拟点击原生页面新对话按钮创建新对话；config消息，携带配置名称和开关状态，负责模拟点击各种配置按钮
4. 原生页面的注入控制
  4.1 我们把url对应页面叫做原生页面，对不同的ai页面使用对应ai类型的策略模式来创建。策略把页面内容的元素进行关联，并加入对应的通讯事件响应逻辑
  4.2 对原生页面的修改：策略对每一次对话的回复内容做一个悬浮工具条，允许用户copy、折叠、展开、隐藏这一条对话。
